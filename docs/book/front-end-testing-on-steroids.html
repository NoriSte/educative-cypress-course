
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>Front-end testing on steroids Â· GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
        <link rel="stylesheet" href="styles/website.css">
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="cypress-as-a-development-tool.html" />
    
    
    <link rel="prev" href="integration-custom-command.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    
    
        
        <li>
            <a href="https://2019.reactjsday.it" target="_blank" class="custom-link">ReactJSDay 2019</a>
        </li>
    
    

    
    <li class="divider"></li>
    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    React Testing Course
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.1.1" data-path="what-are-you-going-to-learn.html">
            
                <a href="what-are-you-going-to-learn.html">
            
                    
                    What you are going to learn (TODO:)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.1.2" data-path="about-us.html">
            
                <a href="about-us.html">
            
                    
                    About us
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.1.3" data-path="files-and-directories.html">
            
                <a href="files-and-directories.html">
            
                    
                    Files and directories TODO:
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    
        
        <li class="divider"></li>
        
        
    
        <li class="chapter " data-level="2.1" >
            
                <span>
            
                    
                    Testing definitions
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.1.1" data-path="what-is-a-test.html">
            
                <a href="what-is-a-test.html">
            
                    
                    What is a test?
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.2" data-path="testing-pyramid.html">
            
                <a href="testing-pyramid.html">
            
                    
                    Testing Pyramid TODO:
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.3" data-path="testing-types.html">
            
                <a href="testing-types.html">
            
                    
                    Testing types TODO:
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2.2" >
            
                <span>
            
                    
                    Testing introduction
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.2.1" data-path="why-testing.html">
            
                <a href="why-testing.html">
            
                    
                    Why Testing? TODO:
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.2.2" data-path="testing-advantages.html">
            
                <a href="testing-advantages.html">
            
                    
                    Testing advantages? TODO:
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.2.3" data-path="testing-rules.html">
            
                <a href="testing-rules.html">
            
                    
                    Testing rules TODO:
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.2.4" data-path="having-fun-while-testing.html">
            
                <a href="having-fun-while-testing.html">
            
                    
                    Having fun while testing TODO:
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.2.5" data-path="what-not-to-test.html">
            
                <a href="what-not-to-test.html">
            
                    
                    What should I not test? TODO:
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.2.6" data-path="the-cost-of-testing.html">
            
                <a href="the-cost-of-testing.html">
            
                    
                    The cost of testing TODO:
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    
        
        <li class="divider"></li>
        
        
    
        <li class="chapter " data-level="3.1" data-path="top-to-bottom.html">
            
                <a href="top-to-bottom.html">
            
                    
                    An easier journey: top to bottom
            
                </a>
            

            
        </li>
    

    
        
        <li class="divider"></li>
        
        
    
        <li class="chapter " data-level="4.1" >
            
                <span>
            
                    
                    E2E Testing
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="4.1.1" data-path="headless-browser.html">
            
                <a href="headless-browser.html">
            
                    
                    Headless browser
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.1.2" data-path="what-is-an-e2e-test.html">
            
                <a href="what-is-an-e2e-test.html">
            
                    
                    What is an E2E test
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="4.2" >
            
                <span>
            
                    
                    The first E2E test
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="4.2.1" data-path="the-realworld-project.html">
            
                <a href="the-realworld-project.html">
            
                    
                    Conduit: the Realworld project
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.2.2" data-path="signup-flow-challenges.html">
            
                <a href="signup-flow-challenges.html">
            
                    
                    Testing the signup flow: challenges
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.2.3" data-path="opening-cypress.html">
            
                <a href="opening-cypress.html">
            
                    
                    Opening Cypress
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.2.4" data-path="interacting-with-the-page.html">
            
                <a href="interacting-with-the-page.html">
            
                    
                    Interacting with the page
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.2.5" data-path="cypress-waitings-and-execution-order.html">
            
                <a href="cypress-waitings-and-execution-order.html">
            
                    
                    Cypress waitings and execution order
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.2.6" >
            
                <span>
            
                    
                    Main E2E test defects
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="4.2.6.1" data-path="e2e-test-defects-determinism.html">
            
                <a href="e2e-test-defects-determinism.html">
            
                    
                    Determinism
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.2.6.2" data-path="e2e-test-defects-stability.html">
            
                <a href="e2e-test-defects-stability.html">
            
                    
                    Stability
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.2.6.3" data-path="utility-in-case-of-failure.html">
            
                <a href="utility-in-case-of-failure.html">
            
                    
                    Utility in case of failure
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="4.3" >
            
                <span>
            
                    
                    Polishing the E2E test
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="4.3.1" >
            
                <span>
            
                    
                    DOM elements selection
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="4.3.1.1" data-path="dom-elements-selection.html">
            
                <a href="dom-elements-selection.html">
            
                    
                    data-testid
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.3.1.2" data-path="cypress-testing-library.html">
            
                <a href="cypress-testing-library.html">
            
                    
                    cypress-testing-library
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="4.3.2" data-path="app-constants.html">
            
                <a href="app-constants.html">
            
                    
                    Sharing app constants
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="4.4" >
            
                <span>
            
                    
                    AJAX requests
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="4.4.1" data-path="waiting-for-ajax-request.html">
            
                <a href="waiting-for-ajax-request.html">
            
                    
                    Waiting for an AJAX request
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.4.2" data-path="payload-assertions.html">
            
                <a href="payload-assertions.html">
            
                    
                    Asserting on payloads
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="4.5" >
            
                <span>
            
                    
                    Custom Commands
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="4.5.1" data-path="signup-custom-command.html">
            
                <a href="signup-custom-command.html">
            
                    
                    Signup
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.5.2" data-path="custom-command-intellisense.html">
            
                <a href="custom-command-intellisense.html">
            
                    
                    Intellisense
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.5.3" data-path="app-actions.html">
            
                <a href="app-actions.html">
            
                    
                    App Actions
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.5.4" data-path="sharing-authentication-state.html">
            
                <a href="sharing-authentication-state.html">
            
                    
                    Sharing authentication state
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="4.6" >
            
                <span>
            
                    
                    UI Integration Tests
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="4.6.1" data-path="stubbing-the-backend.html">
            
                <a href="stubbing-the-backend.html">
            
                    
                    Stubbing the Back-end
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.6.2" data-path="fixtures.html">
            
                <a href="fixtures.html">
            
                    
                    Fixtures
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.6.3" data-path="integration-custom-command.html">
            
                <a href="integration-custom-command.html">
            
                    
                    Custom command
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="4.6.4" data-path="front-end-testing-on-steroids.html">
            
                <a href="front-end-testing-on-steroids.html">
            
                    
                    Front-end testing on steroids
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.6.5" data-path="cypress-as-a-development-tool.html">
            
                <a href="cypress-as-a-development-tool.html">
            
                    
                    Cypress as a development tool
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="4.7" >
            
                <span>
            
                    
                    Other best practices
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="4.7.1" data-path="dedicated-scripts.html">
            
                <a href="dedicated-scripts.html">
            
                    
                    Dedicated scripts
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.7.2" data-path="monitoring-tests.html">
            
                <a href="monitoring-tests.html">
            
                    
                    Monitoring tests
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.7.3" data-path="controlling-the-clock.html">
            
                <a href="controlling-the-clock.html">
            
                    
                    Controlling the clock
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="4.8" data-path="continuous-integration.html">
            
                <a href="continuous-integration.html">
            
                    
                    Continuous integration
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.9" data-path="visual-regression-testing.html">
            
                <a href="visual-regression-testing.html">
            
                    
                    Visual Regression Testnig
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.10" data-path="cypress-vs-other-tools.html">
            
                <a href="cypress-vs-other-tools.html">
            
                    
                    Cypress vs other tools
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.11" data-path="why-is-e2e-testing-not-enough.html">
            
                <a href="why-is-e2e-testing-not-enough.html">
            
                    
                    Why is E2E testing not enough?
            
                </a>
            

            
        </li>
    

    
        
        <li class="divider"></li>
        
        
    
        <li class="chapter " data-level="5.1" data-path="conclusions.html">
            
                <a href="conclusions.html">
            
                    
                    Conclusions TODO:
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.2" data-path="resources.html">
            
                <a href="resources.html">
            
                    
                    Resources
            
                </a>
            

            
        </li>
    

    
        
        <li class="divider"></li>
        
        
    
        <li class="chapter " data-level="6.1" data-path="about-the-book.html">
            
                <a href="about-the-book.html">
            
                    
                    About this book
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >Front-end testing on steroids</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="front-end-testing-on-steroids">Front-end testing on steroids</h1>
<p>Stubbing an AJAX request is easy and advantageous with Cypress, and allows us to concentrate on testing the front-end application, <strong>forgetting about the back-end</strong> one. That&apos;s really important because E2E tests are often considered the only solution to the front-end testing problem, but with so much disadvantages that they discouraged a lot of developers.</p>
<p>Anyway, two of the three main E2E testing problems were front-end developer independence and corner case replication. We can face both of them are easy with UI Integration Testing and back-end stubs. As an example, we could test the error paths that could happen with the registration flow. At the moment, the state of the art of our integration signup flow is the following:</p>
<p><i>File: <a href="../cypress/integration/examples/signup-integration/signup-2.integration.spec.js" target="_blank">cypress/integration/examplessignup-integration/signup-2.integration.spec.js</a></i></p>
<pre><code class="lang-javascript"><span class="hljs-comment">/// &lt;reference types=&quot;Cypress&quot; /&gt;</span>

<span class="hljs-keyword">import</span> { paths } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;../../../../realworld/frontend/src/components/App&quot;</span>;
<span class="hljs-keyword">import</span> { noArticles } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;../../../../realworld/frontend/src/components/ArticleList&quot;</span>;
<span class="hljs-keyword">import</span> { strings } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;../../../../realworld/frontend/src/components/Register&quot;</span>;

context(<span class="hljs-string">&quot;Signup flow&quot;</span>, () =&gt; {
  it(<span class="hljs-string">&quot;The happy path should work&quot;</span>, () =&gt; {
    <span class="hljs-keyword">const</span> user = {
      username: <span class="hljs-string">&quot;Tester&quot;</span>,
      email: <span class="hljs-string">&quot;user@realworld.io&quot;</span>,
      password: <span class="hljs-string">&quot;mysupersecretpassword&quot;</span>
    };

    <span class="hljs-comment">// set up AJAX call interception</span>
    cy.server();
    cy.route(<span class="hljs-string">&quot;POST&quot;</span>, <span class="hljs-string">&quot;**/api/users&quot;</span>, <span class="hljs-string">&quot;fixture:users/signup&quot;</span>).as(<span class="hljs-string">&quot;signup-request&quot;</span>);
    cy.route(<span class="hljs-string">&quot;GET&quot;</span>, <span class="hljs-string">&quot;**/api/tags&quot;</span>, <span class="hljs-string">&quot;fixture:tags/empty-tags&quot;</span>).as(<span class="hljs-string">&quot;tags&quot;</span>);
    cy.route(<span class="hljs-string">&quot;GET&quot;</span>, <span class="hljs-string">&quot;**/api/articles/feed**&quot;</span>, <span class="hljs-string">&quot;fixture:articles/empty-articles&quot;</span>).as(<span class="hljs-string">&quot;feed&quot;</span>);

    cy.visit(paths.register);

    <span class="hljs-comment">// form filling</span>
    cy.findByPlaceholderText(strings.username)
      .type(user.username)
      .findByPlaceholderText(strings.email)
      .type(user.email)
      .findByPlaceholderText(strings.password)
      .type(user.password);

    <span class="hljs-comment">// form submit...</span>
    cy.get(<span class="hljs-string">&quot;form&quot;</span>)
      .within(() =&gt; cy.findByText(strings.signUp))
      .click();

    <span class="hljs-comment">// ... and AJAX call waiting</span>
    cy.wait(<span class="hljs-string">&quot;@signup-request&quot;</span>)
      .should(xhr =&gt;
        expect(xhr.request.body).deep.equal({
          user: {
            username: user.username,
            email: user.email,
            password: user.password
          }
        })
      )
      .wait([<span class="hljs-string">&quot;@tags&quot;</span>, <span class="hljs-string">&quot;@feed&quot;</span>]);

    <span class="hljs-comment">// end of the flow</span>
    cy.findByText(noArticles).should(<span class="hljs-string">&quot;be.visible&quot;</span>);
  });
});
</code></pre>
<p>but there are a lot of error paths that are not been covered yet. The <a href="realworld-project.md">RealWorld</a> front-end does not manage &quot;all&quot; possible paths, but then if the back-end app responds with an error &quot;email/user already registered&quot;, it prints the error as they are.</p>
<p><img src="../assets/images/error-path-1.png" alt="email already used">
<img src="../assets/images/error-path-2.png" alt="email and username already used"></p>
<p>Spying the back-end response, it turns out that its something like <code>{ errors: { email: &quot;is already taken.&quot; } }</code> and the response status is <code>422</code>. We need to reproduce it with the <code>cy.route</code>, <a href="https://docs.cypress.io/api/commands/route.html#Arguments" target="_blank">its options</a> contemplate the <code>status</code> option too. All we need to do is passing all exploded options to the <code>cy.route</code> command</p>
<pre><code class="lang-javascript">cy.route({
  url: <span class="hljs-string">&quot;**/api/users&quot;</span>,
  method: <span class="hljs-string">&quot;POST&quot;</span>,
  status: <span class="hljs-number">422</span>,
  response: { errors: { email: <span class="hljs-string">&quot;is already taken.&quot;</span> } }
}).as(<span class="hljs-string">&quot;signup-request&quot;</span>);
</code></pre>
<p>the <code>url</code>, <code>method</code>, and <code>response</code> are not new, the <code>status</code> option is. With a response like this, the error reported by the front-end is &quot;email is already taken.&quot;. The test is not so many different from the old one (the happy path flow), that&apos;s the full code</p>
<pre><code class="lang-javascript">it(<span class="hljs-string">&quot;Should show an error if the back-end report that the email has already been used&quot;</span>, () =&gt; {
  <span class="hljs-keyword">const</span> user = {
    username: <span class="hljs-string">&quot;Tester&quot;</span>,
    email: <span class="hljs-string">&quot;user@realworld.io&quot;</span>,
    password: <span class="hljs-string">&quot;mysupersecretpassword&quot;</span>
  };

  cy.server();
  cy.route({
    url: <span class="hljs-string">&quot;**/api/users&quot;</span>,
    method: <span class="hljs-string">&quot;POST&quot;</span>,
    status: <span class="hljs-number">422</span>,
    response: { errors: { email: <span class="hljs-string">&quot;is already taken.&quot;</span> } }
  }).as(<span class="hljs-string">&quot;signup-request&quot;</span>);

  cy.visit(paths.register);

  cy.window()
    .its(<span class="hljs-string">&quot;appActions&quot;</span>)
    .invoke(<span class="hljs-string">&quot;signup&quot;</span>, user);

  cy.wait(<span class="hljs-string">&quot;@signup-request&quot;</span>);

  cy.findByText(<span class="hljs-string">&quot;email is already taken.&quot;</span>).should(<span class="hljs-string">&quot;be.visible&quot;</span>);
});
</code></pre>
<p>We could make it even more generic testing the case of multiple errors coming from the back-end</p>
<pre><code class="lang-diff"><span class="hljs-deletion">-it(&quot;Should show an error if the back-end report that the email has already been used&quot;, () =&gt; {</span>
<span class="hljs-addition">+it(&quot;Should show some errors if the back-end reports that some data has already been used&quot;, () =&gt; {</span>
<span class="hljs-addition">+ const response = { errors: { username: &quot;is already taken.&quot;, email: &quot;is already taken.&quot; } };</span>
  const user = {
    username: &quot;Tester&quot;,
    email: &quot;user@realworld.io&quot;,
    password: &quot;mysupersecretpassword&quot;
  };

  cy.server();
  cy.route({
    url: &quot;**/api/users&quot;,
    method: &quot;POST&quot;,
    status: 422,
<span class="hljs-deletion">-   response: { errors: { email: &quot;is already taken.&quot; } }</span>
<span class="hljs-addition">+   response</span>
  }).as(&quot;signup-request&quot;);

  cy.visit(paths.register);

  cy.window()
    .its(&quot;appActions&quot;)
    .invoke(&quot;signup&quot;, user);

  cy.wait(&quot;@signup-request&quot;);

<span class="hljs-deletion">- cy.findByText(&quot;email is already taken.&quot;).should(&quot;be.visible&quot;);</span>
<span class="hljs-addition">+ Object.entries(response.errors).map(([subject, error]) =&gt; {</span>
<span class="hljs-addition">+   cy.findByText(`${subject} ${error}`).should(&quot;be.visible&quot;);</span>
<span class="hljs-addition">+ });</span>
});
</code></pre>
<p>Below there are both the single-error test and the multiple-errors one</p>
<p><i>File: <a href="../cypress/integration/examples/signup-integration/signup-error-paths-1.integration.spec.js" target="_blank">cypress/integration/examplessignup-integration/signup-error-paths-1.integration.spec.js</a></i></p>
<pre><code class="lang-javascript"><span class="hljs-comment">/// &lt;reference types=&quot;Cypress&quot; /&gt;</span>

<span class="hljs-keyword">import</span> { paths } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;../../../../realworld/frontend/src/components/App&quot;</span>;

context(<span class="hljs-string">&quot;Signup flow&quot;</span>, () =&gt; {
  it(<span class="hljs-string">&quot;Should show an error if the back-end report that the email has already been used&quot;</span>, () =&gt; {
    <span class="hljs-keyword">const</span> response = { errors: { email: <span class="hljs-string">&quot;is already taken.&quot;</span> } };
    <span class="hljs-keyword">const</span> user = {
      username: <span class="hljs-string">&quot;Tester&quot;</span>,
      email: <span class="hljs-string">&quot;user@realworld.io&quot;</span>,
      password: <span class="hljs-string">&quot;mysupersecretpassword&quot;</span>
    };

    cy.server();
    cy.route({
      url: <span class="hljs-string">&quot;**/api/users&quot;</span>,
      method: <span class="hljs-string">&quot;POST&quot;</span>,
      status: <span class="hljs-number">422</span>,
      response
    }).as(<span class="hljs-string">&quot;signup-request&quot;</span>);

    cy.visit(paths.register);

    cy.window()
      .its(<span class="hljs-string">&quot;appActions&quot;</span>)
      .invoke(<span class="hljs-string">&quot;signup&quot;</span>, user);

    cy.wait(<span class="hljs-string">&quot;@signup-request&quot;</span>);

    cy.findByText(<span class="hljs-string">`email <span class="hljs-subst">${response.errors.email}</span>`</span>).should(<span class="hljs-string">&quot;be.visible&quot;</span>);
  });

  it(<span class="hljs-string">&quot;Should show some errors if the back-end reports that some data has already been used&quot;</span>, () =&gt; {
    <span class="hljs-keyword">const</span> response = { errors: { username: <span class="hljs-string">&quot;is already taken.&quot;</span>, email: <span class="hljs-string">&quot;is already taken.&quot;</span> } };
    <span class="hljs-keyword">const</span> user = {
      username: <span class="hljs-string">&quot;Tester&quot;</span>,
      email: <span class="hljs-string">&quot;user@realworld.io&quot;</span>,
      password: <span class="hljs-string">&quot;mysupersecretpassword&quot;</span>
    };

    cy.server();
    cy.route({
      url: <span class="hljs-string">&quot;**/api/users&quot;</span>,
      method: <span class="hljs-string">&quot;POST&quot;</span>,
      status: <span class="hljs-number">422</span>,
      response
    }).as(<span class="hljs-string">&quot;signup-request&quot;</span>);

    cy.visit(paths.register);

    cy.window()
      .its(<span class="hljs-string">&quot;appActions&quot;</span>)
      .invoke(<span class="hljs-string">&quot;signup&quot;</span>, user);

    cy.wait(<span class="hljs-string">&quot;@signup-request&quot;</span>);

    <span class="hljs-built_in">Object</span>.entries(response.errors).map(([subject, error]) =&gt; {
      cy.findByText(<span class="hljs-string">`<span class="hljs-subst">${subject}</span> <span class="hljs-subst">${error}</span>`</span>).should(<span class="hljs-string">&quot;be.visible&quot;</span>);
    });
  });
});
</code></pre>
<p>Almost all the code of the tests is the same. Keeping in mind that we must resist adding complex abstractions to the code of the tests (see the <a href="testing-rules.html">testing rules</a><!--TODO: link directly the correct paragraph-->) we could separate some code to a dedicated function and leverage it from the body of the test. After all, only the response changes between the above tests... Take a look at the following code</p>
<p><i>File: <a href="../cypress/integration/examples/signup-integration/signup-error-paths-2.integration.spec.js" target="_blank">cypress/integration/examplessignup-integration/signup-error-paths-2.integration.spec.js</a></i></p>
<pre><code class="lang-javascript"><span class="hljs-comment">/// &lt;reference types=&quot;Cypress&quot; /&gt;</span>

<span class="hljs-keyword">import</span> { paths } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;../../../../realworld/frontend/src/components/App&quot;</span>;

context(<span class="hljs-string">&quot;Signup flow&quot;</span>, () =&gt; {
  <span class="hljs-keyword">const</span> testBody = response =&gt; {
    <span class="hljs-keyword">const</span> user = {
      username: <span class="hljs-string">&quot;Tester&quot;</span>,
      email: <span class="hljs-string">&quot;user@realworld.io&quot;</span>,
      password: <span class="hljs-string">&quot;mysupersecretpassword&quot;</span>
    };

    cy.server();
    cy.route({
      url: <span class="hljs-string">&quot;**/api/users&quot;</span>,
      method: <span class="hljs-string">&quot;POST&quot;</span>,
      status: <span class="hljs-number">422</span>,
      response
    }).as(<span class="hljs-string">&quot;signup-request&quot;</span>);

    cy.visit(paths.register);

    cy.window()
      .its(<span class="hljs-string">&quot;appActions&quot;</span>)
      .invoke(<span class="hljs-string">&quot;signup&quot;</span>, user);

    cy.wait(<span class="hljs-string">&quot;@signup-request&quot;</span>);

    <span class="hljs-built_in">Object</span>.entries(response.errors).map(([subject, error]) =&gt; {
      cy.findByText(<span class="hljs-string">`<span class="hljs-subst">${subject}</span> <span class="hljs-subst">${error}</span>`</span>).should(<span class="hljs-string">&quot;be.visible&quot;</span>);
    });
  };

  it(<span class="hljs-string">&quot;Should show an error if the back-end report that the email has already been used&quot;</span>, () =&gt; {
    testBody({ errors: { email: <span class="hljs-string">&quot;is already taken.&quot;</span> } });
  });

  it(<span class="hljs-string">&quot;Should show some errors if the back-end reports that some data has already been used&quot;</span>, () =&gt; {
    testBody({ errors: { email: <span class="hljs-string">&quot;is already taken.&quot;</span> } });
  });

  it(<span class="hljs-string">&quot;Should show all the errors reported by the back-end as they are&quot;</span>, () =&gt; {
    testBody({ errors: { foo: <span class="hljs-string">&quot;bar&quot;</span>, other: <span class="hljs-string">&quot;problems&quot;</span> } });
  });
});
</code></pre>
<p>The last test checks that the front-end prints the errors as they are, so we are sure that the errors showed to the user are completely driven by the back-end.</p>
<p>Please note that Cypress has other interesting options to simulate network behaviors, like the <a href="https://docs.cypress.io/api/commands/route.html#Use-delays-for-responses" target="_blank"><code>delay</code> option</a> or using a <a href="https://docs.cypress.io/api/commands/route.html#Set-the-routing-options-using-a-callback-function" target="_blank">function as the response</a>, etc.</p>
<p>With the recent examples, it should be clear that E2E testing is good but not practical at all! So, write a few E2E tests (just for the happy paths) and concentrate on the UI Integration Tests.</p>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="integration-custom-command.html" class="navigation navigation-prev " aria-label="Previous page: Custom command">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="cypress-as-a-development-tool.html" class="navigation navigation-next " aria-label="Next page: Cypress as a development tool">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Front-end testing on steroids","level":"4.6.4","depth":2,"next":{"title":"Cypress as a development tool","level":"4.6.5","depth":2,"path":"book/cypress-as-a-development-tool.md","ref":"book/cypress-as-a-development-tool.md","articles":[]},"previous":{"title":"Custom command","level":"4.6.3","depth":2,"path":"book/integration-custom-command.md","ref":"book/integration-custom-command.md","articles":[]},"dir":"ltr"},"config":{"plugins":["include-codeblock","-sharing","include","copy-code-button"],"styles":{"website":"book/styles/website.css"},"pluginsConfig":{"include-codeblock":{"check":false,"edit":false,"lang":"","fixlang":false,"template":"default","theme":"chrome","unindent":false},"include":{},"copy-code-button":{},"highlight":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"theme":"default","pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"variables":{},"links":{"sidebar":{"ReactJSDay 2019":"https://2019.reactjsday.it"},"sharing":{}},"gitbook":"*"},"file":{"path":"book/front-end-testing-on-steroids.md","mtime":"2019-09-19T05:20:24.620Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2019-09-21T13:46:30.919Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-copy-code-button/toggle.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

